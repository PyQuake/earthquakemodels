---
title: "ANOVA test"
author: "Yuri Cossich Lavinas"
date: "April, 2016"
output:
  html_document: default
  pdf_document:
    fig_caption: yes
    fig_crop: no
    toc: yes
  word_document: default
header-includes:
- \usepackage{algorithm}
- \usepackage{algorithmic}
---
```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(dev='pdf')
setwd("~/Documents/estudos/unb/earthquakemodels/Zona2/dataForR")
```



## Summary
  
O objeto é descobrir se existem variações ente os métodos e quais são as variáveis mais influentes.

Os métodos utilizados para comparação são o gaModel e a versão com listas. Para cada um dos métodos temos algumas variações nas varíaveis utilizadas. Variamos os anos (2005-2010), as regiões (Kanto, EastJapan, Touhoku e Kansai), a profundidade ( <25km, <60km, <100km) e finalmente o catálogo utilizado (JMA X métodoJanelaJMA).

## Experimental design
Vou utilizar o ANOVA para nos dados obtidos para verificar qual composição de variáveis e métodos mais influênciam no resultado final.

Para isso executei o *gaModel* e *versão com Listas* para cada conjunto de variáveis 10 vezes. Cada grupo para um método é composto por: região, ano, profundidade e catálogo. Um grupo para um cenário será chamado cenário de execução.

Após as execuções vou aplicar o ANOVA em uma data.frame composto pelos dados das **médias dos melhores indivíduos da última geração** para cada cenário de execução. 

Caso uma variável esteja fora do intervalo de confiança (P < 0.05), vou aplicar novamente o ANOVA retirando essa variável do teste. 

Aplico um teste post hoc nos resultados do ANOVO oara especificar quais são os grupos que diferem. O teste utilizado foi o Tukey teste.

## Statistical Analysis
Começo a análise carregando o data.frame com os dados, seguindo para a aplicação do teste ANOVA e finalizando com o uso do Tukey teste.

```{r}
#Loading data
load("data.Rda")
#Taking a look at the data
summary(finalData)
#Primeira vez aplicando ANOVA
resultANOVA = aov(finalData$loglikeValues~finalData$model+finalData$depths+finalData$years+finalData$regions)
summary(resultANOVA)
#Segunda vez aplicando ANOVA, como a variável years influencia menos os dados foram removidos do teste ANOVA
resultANOVA = aov(finalData$loglikeValues~finalData$model+finalData$depths+finalData$regions)
summary(resultANOVA)
#Especificando quais são os grupos que diferem
tuk = TukeyHSD(resultANOVA)
#Variáveis para configuração do gráfico
# par(mfrow=c(2,2))
op <- par(mar = c(5,12,4,2) + 0.1)
#Função para gerar o gráfico
plot(tuk,las=1)
#Mostrando os resultados também em texto
print(tuk)
```

## Conclusions

